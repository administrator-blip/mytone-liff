// MYTONE Service Worker - NetworkFirst戦略\nconst CACHE_NAME = 'mytone-v1';\n\n// インストール時にキャッシュ\nself.addEventListener('install', (event) => {\n  event.waitUntil(\n    caches.open(CACHE_NAME).then((cache) => {\n      return cache.addAll([\n        './index.html',\n        './manifest.json'\n      ]);\n    })\n  );\n  self.skipWaiting();\n});\n\n// アクティベート時に古いキャッシュを削除\nself.addEventListener('activate', (event) => {\n  event.waitUntil(\n    caches.keys().then((keys) => {\n      return Promise.all(\n        keys.filter(key => key !== CACHE_NAME).map(key => caches.delete(key))\n      );\n    })\n  );\n  self.clients.claim();\n});\n\n// NetworkFirst: ネットワーク優先、失敗時にキャッシュ\nself.addEventListener('fetch', (event) => {\n  // APIリクエストはキャッシュしない\n  if (event.request.method !== 'GET') return;\n  \n  event.respondWith(\n    fetch(event.request)\n      .then((response) => {\n        // 正常レスポンスをキャッシュに保存\n        const clone = response.clone();\n        caches.open(CACHE_NAME).then((cache) => {\n          cache.put(event.request, clone);\n        });\n        return response;\n      })\n      .catch(() => {\n        // ネットワーク失敗時はキャッシュから返す\n        return caches.match(event.request);\n      })\n  );\n});\n
